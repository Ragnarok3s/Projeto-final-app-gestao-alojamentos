<div class="dialog-backdrop">
  <div class="dialog">
    <div class="dialog-header">
      <h3>Nova reserva</h3>
      <button class="btn btn-secondary" type="button" (click)="cancel()">Fechar</button>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" class="dialog-body">
      <ng-container *ngIf="step === 1">
        <div class="form-row">
          <label for="unitId">Selecionar unidade</label>
          <select id="unitId" formControlName="unitId">
            <option [ngValue]="null" disabled hidden>Escolhe uma unidade...</option>
            <option *ngFor="let unit of (units$ | async)" [value]="unit.id">{{ unit.name }}</option>
          </select>
          <div class="error" *ngIf="unitControl?.invalid && (unitControl.dirty || unitControl.touched)">
            Seleciona uma unidade.
          </div>
        </div>

        <div class="dialog-actions">
          <button class="btn btn-primary" type="button" (click)="nextStep()">Continuar</button>
        </div>
      </ng-container>

      <ng-container *ngIf="step === 2">
        <div class="form-row">
          <label for="startDate">Data de início</label>
          <input id="startDate" type="datetime-local" formControlName="startDate" />
          <div class="error" *ngIf="startDateControl?.invalid && (startDateControl.dirty || startDateControl.touched)">
            Campo obrigatório.
          </div>
        </div>

        <div class="form-row">
          <label for="endDate">Data de fim</label>
          <input id="endDate" type="datetime-local" formControlName="endDate" />
          <div class="error" *ngIf="endDateControl?.invalid && (endDateControl.dirty || endDateControl.touched)">
            Campo obrigatório.
          </div>
        </div>

        <div class="form-row">
          <label for="guestName">Nome do hóspede</label>
          <input id="guestName" type="text" formControlName="guestName" />
          <div class="error" *ngIf="guestNameControl?.invalid && (guestNameControl.dirty || guestNameControl.touched)">
            Campo obrigatório.
          </div>
        </div>

        <div class="form-row">
          <label for="guestContact">Contacto</label>
          <input id="guestContact" type="text" formControlName="guestContact" />
        </div>

        <div class="form-row">
          <label for="notes">Notas</label>
          <textarea id="notes" rows="3" formControlName="notes"></textarea>
        </div>

        <div class="form-row">
          <label for="status">Estado</label>
          <select id="status" formControlName="status">
            <option value="CONFIRMED">Confirmada</option>
            <option value="CANCELLED">Cancelada</option>
          </select>
        </div>

        <div class="error" *ngIf="form.errors?.['dateRangeInvalid']">Data de início tem de ser anterior à data de fim.</div>

        <div class="error global" *ngIf="error$ | async as error">{{ error }}</div>

        <div class="dialog-actions">
          <button class="btn btn-secondary" type="button" (click)="cancel()">Cancelar</button>
          <button class="btn btn-primary" type="submit">Guardar reserva</button>
        </div>
      </ng-container>
    </form>
  </div>
</div>
